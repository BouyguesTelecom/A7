FROM golang:1.21

ARG XK6_VERSION=v0.12.2

ENV BASE_URL "http://localhost:45537"
ENV STAGE_DURATION 30
ENV AVERAGE_LOAD_ITER_PER_SEC 15
ENV AVERAGE_LOAD_ITER_VARIATION 5
ENV AUTOSCALING_ITER_PER_SEC 20
ENV STRESS_LOAD_MIN_ITER_PER_SEC 32
ENV STRESS_LOAD_MAX_ITER_PER_SEC 59


WORKDIR /app

RUN go install go.k6.io/xk6/cmd/xk6@${XK6_VERSION}
RUN xk6 build ${XK6_VERSION}

COPY loadtesting.js /app

CMD ["./k6", "run", "/app/loadtesting.js"]
